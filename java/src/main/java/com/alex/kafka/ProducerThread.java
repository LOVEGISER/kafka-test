package com.alex.kafka;

import com.alex.kafka.bean.ClickLog;
import com.alibaba.fastjson.JSONObject;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Random;
import java.util.UUID;

@Component
public class ProducerThread implements CommandLineRunner {
    @Autowired
    private Producer producer;

    @Override
    public void run(String... args) throws Exception {
        System.out.println("The Runner start to initialize ...");
        String strDateFormat = "yyyy-MM-dd HH:mm:ss";

        try {
            for(int j =0 ; j<50000;j++){
              int batchSize = 1000;
                for(int i = 0 ; i<batchSize ;i++){
                   /* ClickLog clickLog  = new ClickLog();
                    clickLog.setId(UUID.randomUUID().toString());
                    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(strDateFormat);
                    clickLog.setClickTime(simpleDateFormat.format(new Date()));
                    clickLog.setType("webset");
                    clickLog.setUser("user"+ new Random().nextInt(1000) +i);
                    producer.sendMessage(Constant.topicName, JSONObject.toJSONString(clickLog));*/
                    String s = " {\"@timestamp\":\"2022-08-23T09:39:27.965Z\",\"Hostname\":\"al-bj2c-prod.k8s-worker-webserver-002\",\"beat\":{\"hostname\":\"al-bj2c-prod.k8s-worker-webserver-002\",\"name\":\"al-bj2c-prod.k8s-worker-webserver-002\",\"version\":\"5.6.16\"},\"input_type\":\"log\",\"message\":\"NOTICE: 08-23 17:39:27 logId[2335082265589e33d1604810d61d61ce4c9dc22bdff7] host[api.soyoung.com] uri[/v8/cure/Recommend] user[{\\\"xysource\\\":0,\\\"ip\\\":\\\"183.137.88.201\\\",\\\"uid\\\":\\\"0\\\",\\\"cookieUid\\\":\\\"1661247057405157591\\\",\\\"session_id\\\":\\\"\\\"}] get[{\\\"api\\\":\\\"cure\\\"}] post[{\\\"device_model\\\":\\\"OPPO-PEMM20\\\",\\\"lver\\\":\\\"9.8.0\\\",\\\"cityId\\\":\\\"175\\\",\\\"s_personalize\\\":\\\"0\\\",\\\"vistor_uid\\\":\\\"184852089\\\",\\\"page_display_unique_id\\\":\\\"d6da63ff37a395cb2c1dbc00ea77aa1d\\\",\\\"sys\\\":\\\"2\\\",\\\"is_64\\\":\\\"1\\\",\\\"sm_device_id\\\":\\\"BaB25we9FGstspDTsiHNQ+iwLYXemMZCGgpGST8W6UkAXyfTVccUNqHrZsuj\\\",\\\"uid\\\":\\\"0\\\",\\\"sdk_version\\\":\\\"31\\\",\\\"is_tf\\\":\\\"1\\\",\\\"_time\\\":\\\"1661247567\\\",\\\"app_id\\\":\\\"2\\\",\\\"_jk\\\":\\\"6394131\\\",\\\"device_id\\\":\\\"319167515\\\",\\\"start_up_id\\\":\\\"30_206688\\\",\\\"xy_token\\\":\\\"19deadadb9373ec69e1288561dc*****\\\",\\\"s_meng_device_id\\\":\\\"DuAovEW1RdQxeraCjCa4ASzeUDDTDqd1AkrnLEJH2cc2jM45PerHC1mOfXsrTXZ0mo8J4Alu9YOMlnN0GqeLQotA\\\",\\\"xy_sign\\\":\\\"JHeuKjQdGoGM8HXB1dsGlg%3D%3D\\\",\\\"filter\\\":\\\"{}\\\",\\\"pinyin\\\":\\\"samsung\\\",\\\"recommend_tab_id\\\":\\\"3\\\",\\\"device_os_version\\\":\\\"12\\\",\\\"page\\\":\\\"0\\\",\\\"xy_device_token\\\":\\\"5a94400f8ccd19982e3d8ddfef7c3ff5f1\\\",\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"request_id\\\":\\\"9cf40a167ffc3bde454249b9534c8a44\\\"}] refer[] brower[Dalvik/2.1.0 (Linux; U; Android 12; PEMM20 Build/SP1A.210812.016)] timeLog[load-config_ms=2 _pub_params_ms=6 runAction_ms=171 chkSignCommon_ms=0 Cure_actionCureRecommend_ms=165 liao_doctor_getCureRecommend_ms=45 _getCureRecommendDoctor_MultiRPC_ms=119 _render_ms=5 _check_json__ms=0 afterAction_ms=0] notice[zone=bj2c beforeAction=11 CommonParamsService%3A%3AgetIndexRecommendParams={\\\"uid\\\":\\\"-319167515\\\",\\\"device_id\\\":\\\"319167515\\\",\\\"request_id\\\":\\\"9cf40a167ffc3bde454249b9534c8a44\\\",\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"limit\\\":8,\\\"device_model\\\":\\\"OPPO-PEMM20\\\",\\\"sys\\\":2,\\\"version\\\":\\\"9.8.0\\\",\\\"city_id\\\":175,\\\"page\\\":0,\\\"tab_index\\\":\\\"0\\\",\\\"personalize_rec\\\":0,\\\"ip\\\":\\\"183.137.88.201\\\",\\\"timestamp\\\":1661247567,\\\"ext\\\":{\\\"filter\\\":[]},\\\"lat\\\":\\\"\\\",\\\"lng\\\":\\\"\\\"} makeCommerceAdSign_str=app_key=yjkrk0m4tj3v7ace\\u0026front_param={\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"city_id\\\":175,\\\"device_id\\\":\\\"319167515\\\",\\\"lat\\\":\\\"\\\",\\\"limit\\\":8,\\\"lng\\\":\\\"\\\",\\\"login_user\\\":true,\\\"new_user\\\":true,\\\"page\\\":0,\\\"personalize_rec\\\":0,\\\"request_id\\\":\\\"9cf40a167ffc3bde454249b9534c8a44\\\",\\\"sys\\\":2,\\\"uid\\\":\\\"-319167515\\\",\\\"version\\\":\\\"9.8.0\\\"}\\u0026params={\\\"sort\\\":0}\\u0026timestamp=1661247567766\\u002658d78a447ace841a727996e8d196d9b757e91c40 zone_java_commerce_ad_server=other_zone_172.16.231.213 params_commerceCommonRecommend_yjkrk0m4tj3v7ace={\\\"app_key\\\":\\\"yjkrk0m4tj3v7ace\\\",\\\"front_param\\\":{\\\"request_id\\\":\\\"9cf40a167ffc3bde454249b9534c8a44\\\",\\\"uid\\\":\\\"-319167515\\\",\\\"new_user\\\":true,\\\"login_user\\\":true,\\\"page\\\":0,\\\"limit\\\":8,\\\"version\\\":\\\"9.8.0\\\",\\\"sys\\\":2,\\\"device_id\\\":\\\"319167515\\\",\\\"city_id\\\":175,\\\"lat\\\":\\\"\\\",\\\"lng\\\":\\\"\\\",\\\"personalize_rec\\\":0,\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\"},\\\"params\\\":{\\\"sort\\\":0},\\\"timestamp\\\":1661247567766,\\\"sign\\\":\\\"F94C4CC046E2CF78D475BFD6D53DA6AA\\\"} result_commerceCommonRecommend_yjkrk0m4tj3v7ace={\\\"code\\\":0,\\\"data\\\":{\\\"items\\\":[{\\\"b_diff_area\\\":false,\\\"ext\\\":{\\\"zt_planmaterial_type\\\":43,\\\"hid\\\":106529,\\\"item_id\\\":138075,\\\"item_type\\\":43,\\\"zt_tplan_type\\\":\\\"1\\\",\\\"zt_business_kind\\\":\\\"101\\\",\\\"ac_type\\\":300,\\\"zt_business_item\\\":\\\"1\\\",\\\"server_id\\\":1,\\\"zt_tplanid\\\":740261,\\\"zt_planmaterial_id\\\":138075,\\\"strategy_id\\\":1579,\\\"zt_pre_serial_num\\\":1,\\\"position\\\":1,\\\"source_id\\\":3,\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"key\\\":\\\"43_138075_9cf40a167ffc3bde454249b9534c8a44\\\",\\\"place_id\\\":10006,\\\"request_key\\\":\\\"43_138075_9cf40a167ffc3bde454249b9534c8a44\\\",\\\"timestamp\\\":1661247567810,\\\"zt_plat_type\\\":\\\"1\\\"},\\\"hospital_id\\\":106529,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":138075,\\\"item_type\\\":43,\\\"position\\\":1,\\\"product_list\\\":[430188,633255,639124,1218858]},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":43,\\\"hid\\\":23774,\\\"rank_sco\\\":21.00972326103216,\\\"item_type\\\":43,\\\"sub_strategy_id\\\":\\\"2022\\\",\\\"score\\\":2.100972326103216,\\\"rank_sco_ori\\\":2.100972326103216,\\\"zt_planmaterial_id\\\":162423,\\\"zt_pre_serial_num\\\":2,\\\"key\\\":\\\"43_162423_9cf40a167ffc3bde454249b9534c8a44\\\",\\\"place_id\\\":10006,\\\"timestamp\\\":1661247567810,\\\"item_id\\\":162423,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":39123618,\\\"strategy_id\\\":364,\\\"position\\\":2,\\\"source_id\\\":4,\\\"zt_cplanid\\\":266359,\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"43_162423_9cf40a167ffc3bde454249b9534c8a44\\\"},\\\"hospital_id\\\":23774,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":162423,\\\"item_type\\\":43,\\\"position\\\":2,\\\"product_list\\\":[509366,627220,1114230,509358],\\\"score\\\":2.100972326103216},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":43,\\\"hid\\\":4498,\\\"rank_sco\\\":20.992063492063494,\\\"item_type\\\":43,\\\"sub_strategy_id\\\":\\\"2022\\\",\\\"score\\\":2.0992063492063493,\\\"rank_sco_ori\\\":2.0992063492063493,\\\"zt_planmaterial_id\\\":59414,\\\"zt_pre_serial_num\\\":3,\\\"key\\\":\\\"43_59414_9cf40a167ffc3bde454249b9534c8a44\\\",\\\"place_id\\\":10006,\\\"timestamp\\\":1661247567810,\\\"item_id\\\":59414,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":37971660,\\\"strategy_id\\\":364,\\\"position\\\":3,\\\"source_id\\\":4,\\\"zt_cplanid\\\":280342,\\\"ab_id\\\":\\\"C77FDEBF300C0E724E0C65138B-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"43_59414_9cf40a167ffc3bde454249b9534c8a44\\\"},\\\"hospital_id\\\":4498,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":59414,\\\"item_type\\\":43,\\\"position\\\":3,\\\"product_list\\\":[376391,960,217586,217581],\\\"score\\\":2.0992063492063493},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":43,\\\"hid\\\":185680,\\\"rank_sco\\\":20.25,\\\"item_type\\\":43,\\\"sub_strategy_id\\\":\\\"2022\\\",\\\"score\\\":2.025,\\\"rank_sco_ori\\\":2.025,\\\"zt_planmaterial_id\\\":208538,\\\"zt_pre_serial_num\\\":4,\\\"key\\\":\\\"43_208538_9cf40a167ffc3bde454249b9534c8a44\\\",\\\"place_id\\\":10006,\\\"timestamp\\\":1661247567810,\\\"item_id\\\":208538,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1\":200,\\\"timestamp\\\":1661247566986,\\\"item_id\\\":634812,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":39151741,\\\"rank_model_sco\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"rank_model\\\":\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\",\\\"strategy_id\\\":317,\\\"position\\\":6,\\\"source_id\\\":4,\\\"zt_cplanid\\\":269854,\\\"ab_id\\\":\\\"87B2B54F488CD1A194BB373B40-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"33_634812_6bbe78beb2e659cb414a77edfa8c9b41\\\"},\\\"hospital_id\\\":107379,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":634812,\\\"item_type\\\":33,\\\"menu1_id_list\\\":[10023],\\\"position\\\":6,\\\"rank_model_score_map\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"score\\\":5.0},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":33,\\\"hid\\\":107379,\\\"rank_sco\\\":0.01497901883694907,\\\"item_type\\\":33,\\\"sub_strategy_id\\\":\\\"16001\\\",\\\"score\\\":5.0,\\\"rank_sco_ori\\\":0.027499279,\\\"zt_planmaterial_id\\\":568562,\\\"zt_pre_serial_num\\\":7,\\\"key\\\":\\\"33_568562_6bbe78beb2e659cb414a77edfa8c9b41\\\",\\\"place_id\\\":200,\\\"timestamp\\\":1661247566986,\\\"item_id\\\":568562,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":39151738,\\\"rank_model_sco\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"rank_model\\\":\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\",\\\"strategy_id\\\":317,\\\"position\\\":7,\\\"source_id\\\":4,\\\"zt_cplanid\\\":270012,\\\"ab_id\\\":\\\"87B2B54F488CD1A194BB373B40-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"33_568562_6bbe78beb2e659cb414a77edfa8c9b41\\\"},\\\"hospital_id\\\":107379,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":568562,\\\"item_type\\\":33,\\\"menu1_id_list\\\":[10009],\\\"position\\\":7,\\\"rank_model_score_map\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"score\\\":5.0},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":33,\\\"hid\\\":107379,\\\"rank_sco\\\":0.014331648886182529,\\\"item_type\\\":33,\\\"sub_strategy_id\\\":\\\"16001\\\",\\\"score\\\":5.0,\\\"rank_sco_ori\\\":0.029291363,\\\"zt_planmaterial_id\\\":969461,\\\"zt_pre_serial_num\\\":8,\\\"key\\\":\\\"33_969461_6bbe78beb2e659cb414a77edfa8c9b41\\\",\\\"place_id\\\":200,\\\"timestamp\\\":1661247566986,\\\"item_id\\\":969461,\\\"zt_business_kind\\\":\\\"202\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":39151780,\\\"rank_model_sco\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.029291363},\\\"rank_model\\\":\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\",\\\"strategy_id\\\":317,\\\"position\\\":8,\\\"source_id\\\":4,\\\"zt_cplanid\\\":268932,\\\"ab_id\\\":\\\"87B2B54F488CD1A194BB373B40-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"33_969461_6bbe78beb2e659cb414a77edfa8c9b41\\\"},\\\"hospital_id\\\":107379,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":969461,\\\"item_type\\\":33,\\\"menu1_id_list\\\":[10006],\\\"position\\\":8,\\\"rank_model_score_map\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.029291363},\\\"score\\\":5.0},{\\\"ext\\\":{\\\"zt_planmaterial_type\\\":33,\\\"hid\\\":107379,\\\"rank_sco\\\":0.014251608111714803,\\\"item_type\\\":33,\\\"sub_strategy_id\\\":\\\"16001\\\",\\\"score\\\":5.0,\\\"rank_sco_ori\\\":0.027499279,\\\"zt_planmaterial_id\\\":1212090,\\\"zt_pre_serial_num\\\":9,\\\"key\\\":\\\"33_1212090_6bbe78beb2e659cb414a77edfa8c9b41\\\",\\\"place_id\\\":200,\\\"timestamp\\\":1661247566986,\\\"item_id\\\":1212090,\\\"zt_business_kind\\\":\\\"201\\\",\\\"ac_type\\\":100,\\\"zt_business_item\\\":\\\"2\\\",\\\"server_id\\\":1,\\\"zt_plan_material_log_id\\\":39151611,\\\"rank_model_sco\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"rank_model\\\":\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\",\\\"strategy_id\\\":317,\\\"position\\\":9,\\\"source_id\\\":4,\\\"zt_cplanid\\\":282354,\\\"ab_id\\\":\\\"87B2B54F488CD1A194BB373B40-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"request_key\\\":\\\"33_1212090_6bbe78beb2e659cb414a77edfa8c9b41\\\"},\\\"hospital_id\\\":107379,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":1212090,\\\"item_type\\\":33,\\\"menu1_id_list\\\":[10015],\\\"position\\\":9,\\\"rank_model_score_map\\\":{\\\"XGB_PRODUCT_PRODUCT_CTR_ZH2\\\":0.027499279},\\\"score\\\":5.0},{\\\"brand_id\\\":[],\\\"copy_id\\\":0,\\\"ext\\\":{\\\"zt_planmaterial_type\\\":33,\\\"hid\\\":148272,\\\"item_id\\\":1008928,\\\"item_type\\\":33,\\\"sub_strategy_id\\\":\\\"80001\\\",\\\"server_id\\\":1,\\\"score\\\":0.5769230769230769,\\\"rank_sco_ori\\\":0.07692307692307693,\\\"zt_planmaterial_id\\\":1008928,\\\"strategy_id\\\":292,\\\"zt_pre_serial_num\\\":10,\\\"position\\\":10,\\\"source_id\\\":4,\\\"ab_id\\\":\\\"87B2B54F488CD1A194BB373B40-1MqMJ\\\",\\\"db\\\":\\\"2022-08-23\\\",\\\"key\\\":\\\"33_1008928_6bbe78beb2e659cb414a77edfa8c9b41\\\",\\\"place_id\\\":200,\\\"request_key\\\":\\\"33_1008928_6bbe78beb2e659cb414a77edfa8c9b41\\\",\\\"timestamp\\\":1661247566986},\\\"hospital_id\\\":148272,\\\"inter_ext\\\":{\\\"bid_price\\\":\\\"0.01\\\"},\\\"item_id\\\":1008928,\\\"item_type\\\":33,\\\"menu1_id_list\\\":[10010],\\\"position\\\":10,\\\"product_sell_count\\\":0,\\\"score\\\":0.5769230769230769}],\\\"strategy_id\\\":317},\\\"msg\\\":\\\"SUCCESS\\\",\\\"success\\\":true} redis%20conn%20info=sy-trade.redis.rds.aliyuncs.com-6379 zone_php_doctor_server=this_zone_bj2c userHasReceiveWeiKuanIds=[] weikuan_listReceiveCoupon=[[],[]] calculateToPayCouponIdList0=[] start_viewSubsidyByPid=[{\\\"pid\\\":\\\"295957\\\",\\\"hospital_id\\\":\\\"28542\\\",\\\"price\\\":\\\"3980\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"966034\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"680\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"1103645\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"13800\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"600328\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1280\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"969197\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1680\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"634812\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"998\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"568562\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"680\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"969461\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1880\\\",\\\"hospital_role\\\":2},{\\\"pid\\\":\\\"1212090\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"8800\\\",\\\"hospital_role\\\":2}] end_viewSubsidyByPid=[{\\\"pid\\\":\\\"295957\\\",\\\"hospital_id\\\":\\\"28542\\\",\\\"price\\\":\\\"3980\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"12\\\",\\\"subsidy_price\\\":477},{\\\"pid\\\":\\\"966034\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"680\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"8\\\",\\\"subsidy_price\\\":54},{\\\"pid\\\":\\\"1103645\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"13800\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"8\\\",\\\"subsidy_price\\\":1104},{\\\"pid\\\":\\\"600328\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1280\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"9\\\",\\\"subsidy_price\\\":115},{\\\"pid\\\":\\\"969197\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1680\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"3\\\",\\\"subsidy_price\\\":50},{\\\"pid\\\":\\\"634812\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"998\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"9\\\",\\\"subsidy_price\\\":89},{\\\"pid\\\":\\\"568562\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"680\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"9\\\",\\\"subsidy_price\\\":61},{\\\"pid\\\":\\\"969461\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"1880\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"8\\\",\\\"subsidy_price\\\":150},{\\\"pid\\\":\\\"1212090\\\",\\\"hospital_id\\\":\\\"107379\\\",\\\"price\\\":\\\"8800\\\",\\\"hospital_role\\\":2,\\\"hospital_purchase_restrictions\\\":0,\\\"pid_purchase_restriction\\\":0,\\\"b_subsidy_price\\\":0,\\\"subsidy_ratio\\\":\\\"3\\\",\\\"subsidy_price\\\":264}] ProductBestPrice_viewSubsidyByPid={0:{ 0: { pid : 295957 , hospital_id : 28542 , price : 3980 , hospital_role :2,}, 1: { pid : 966034 , hospital_id : 107379 , price : 680 , hospital_role :2,}, 2: { pid : 1103645 , hospital_id : 107379 , price : 13800 , hospital_role :2,}, 3: { pid : 600328 , hospital_id : 107379 , price : 1280 , hospital_role :2,}, 4: { pid : 969197 , hospital_id : 107379 , price : 1680 , hospital_role :2,}, 5: { pid : 634812 , hospital_id : 107379 , price : 998 , hospital_role :2,}, 6: { pid : 568562 , hospital_id : 107379 , price : 680 , hospital_role :2,}, 7: { pid : 969461 , hospital_id : 107379 , price : 1880 , hospital_role :2,}, 8: { pid : 1212090 , hospital_id : 107379 , price : 8800 , hospital_role :2,},}, 1:{ 0: { pid : 295957 , hospital_id : 28542 , price : 3980 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 12 , subsidy_price :477,}, 1: { pid : 966034 , hospital_id : 107379 , price : 680 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 8 , subsidy_price :54,}, 2: { pid : 1103645 , hospital_id : 107379 , price : 13800 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 8 , subsidy_price :1104,}, 3: { pid : 600328 , hospital_id : 107379 , price : 1280 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 9 , subsidy_price :115,}, 4: { pid : 969197 , hospital_id : 107379 , price : 1680 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 3 , subsidy_price :50,}, 5: { pid : 634812 , hospital_id : 107379 , price : 998 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 9 , subsidy_price :89,}, 6: { pid : 568562 , hospital_id : 107379 , price : 680 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 9 , subsidy_price :61,}, 7: { pid : 969461 , hospital_id : 107379 , price : 1880 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 8 , subsidy_price :150,}, 8: { pid : 1212090 , hospital_id : 107379 , price : 8800 , hospital_role :2, hospital_purchase_restrictions :0, pid_purchase_restriction :0, b_subsidy_price :0, subsidy_ratio : 3 , subsidy_price :264,},},) handleProductBestCouponwei_kuan_max_cut0_1103645=[11454,11454,11404,11404] handleProductBestCouponwei_kuan_max_cut0_969197=[1479,1479,1429,1429] handleProductBestCouponwei_kuan_max_cut0_969461=[1561,1561,1511,1511] handleProductBestCouponwei_kuan_max_cut0_1212090=[7744,7744,7694,7694] zone_php_mck_server=this_zone_bj2c verifyOrderReturnTheCash=[\\\"99\\\",\\\"2\\\",\\\"148272\\\",\\\"0\\\",[10010],0,0,0,1,0,0,0,1,8440] _errorCode=0 _errorMsg=] isAjax[0] appVer[8.44.0] dbConnCnt[DbHost_c-proxysql.sy.soyoung.com_ConnCnt_21] sqlCnt[12,18ms] esCnt[0,0ms] cacheCnt[read:12,write:10,time:1] rpcCnt[4,32ms] execTime[196]\",\"offset\":26643803034,\"source\":\"/www/site/logs/202208/app_notice_23.log\",\"type\":\"notice-api\"}";
                    producer.sendMessage(Constant.topicName, JSONObject.toJSONString(clickLog));

                }
               // Thread.sleep(50L);
                Constant.msgCount += batchSize;
                System.out.println("msgCount:"+Constant.msgCount);
            }
            System.out.println("msgCount:"+Constant.msgCount);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }
}